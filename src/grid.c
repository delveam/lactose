#include <string.h>
#include "grid.h"

static Cell map[GRID_WIDTH * GRID_HEIGHT];

void InitWorld()
{
    Cell temp[] =
    {
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    };

    memcpy(map, temp, sizeof(Cell) * GRID_WIDTH * GRID_HEIGHT);
}

void DrawWorld()
{
    for (int y = 0; y < GRID_HEIGHT; ++y)
    {
        for (int x = 0; x < GRID_WIDTH; ++x)
        {
            if (GetCell(x, y) == WALL)
            {
                DrawRectangle(x * GRID_SIZE, y * GRID_SIZE, GRID_SIZE, GRID_SIZE, BLACK);
            }
        }
    }
}

Cell GetCell(int x, int y)
{
    if (x >= GRID_WIDTH || x < 0 || y >= GRID_HEIGHT || y < 0)
    {
        return NONE;
    }

    return map[y * GRID_WIDTH + x];
}

Coord ScreenToGrid(float x, float y)
{
    int xGrid = (int)x / GRID_SIZE;
    int yGrid = (int)y / GRID_SIZE;

    Coord result = { xGrid, yGrid };
    return result;
}

Vector2 GridToScreen(int x, int y)
{
    float xScreen = x * GRID_SIZE + GRID_SIZE / 2;
    float yScreen = y * GRID_SIZE + GRID_SIZE / 2;

    Vector2 result = { xScreen, yScreen };
    return result;
}